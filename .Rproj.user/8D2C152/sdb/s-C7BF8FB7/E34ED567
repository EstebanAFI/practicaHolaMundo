{
    "contents" : "\nrm(list=ls())\n\n###################################################################################\n#                            EJERCICIO-1                                          #\n###################################################################################\n# Obtencion del fichero de precios\n# Utilizamos la funcion SCAN que nos devuelve un vector.\n\nfile.precios <-scan(\"precios.txt\")\n\n##### CALCULO DE VECTOR MUESTRA DE RENDIMIENTOS #######\n\n##  Utilizamos la función diff aprovechando la cualidad de los logaritmos\n##  por la cual el log de un cociente es igual a la diferencia de logaritmos del\n#   numerador y denominador\n\nfile.rendimiento <- diff(log(file.precios))\n\n#-- realizamos una primera observación de los estadísticos representativos de la muestra\n\nsummary(file.rendimiento)\n\n\n\n# De la población solo conocemos que sigue una distribución normal, por lo que para\n# estimar la varianza utilizamos el estadístico apoyado en ladistribución de chi-cuadrado\n\ntamaño.muestra.r <- length(file.rendimiento)\n\ncota.inferior <- tamaño.muestra.r*var(file.rendimiento)/ qchisq(0.975,tamaño.muestra.r -1)\ncota.superior <- tamaño.muestra.r*var(file.rendimiento)/ qchisq(0.025,tamaño.muestra.r -1)\n\nprint(paste(\"cota inferior:\", cota.inferior)) # 0.000185729256763415\nprint(paste(\"cota superior:\",cota.superior)) # 0.000416833672429882\n\n\ncuasivarianza<- (tamaño.muestra.r / (tamaño.muestra.r - 1))*var(file.rendimiento)\n\n\n# Ajustamos los datos muestrales a una normal, utilizando el metodo de máxima\n# verosimilitud\n# Nos apoyamos en el paquete MASS\n#library(MASS)\n#resultado<-fitdistr(file.rendimiento,\"normal\")\n\n#print(resultado)# 0.0161747558\n\n#hist(file.rendimiento,col=rainbow(3),main=\"frecuencia\",\n#     ylab=\"$\",xlab=\"rendimiento\")\n\n\n\n#################################################################################\n#                       2º- EJERCICIO                                           #\n#################################################################################\n\n\n\n\n#----- POBLACION normal 16 onzas y desvicion  0.12\n# Hacemos una representación de su función de densidad del 99% de los valores\n\nx<-seq(15.6,16.4,length.out=100)\npaquete.cereales<-dnorm(x,16,0.12)\nplot(x,paquete.cereales,type='l')\n\n\n#--- Ejercicio 3.1\n#---- probabilidad x<15.95\npnorm(15.95,16,0.12) # 0.3384\n\n\n\n#---Ejercicio 3.2\n#---- muestra de 16 paquetes  contenga al menos 15.95\n# la muestra sigue un distribucion N(16,0.12/sqrt(16))\n\npnorm(15.95,16,0.03)  # 0.04779035\n\n\n\n#----- Ejercicio 2.3.\n# Se reliza un contraste de la media sobre una población Normal con parámetros\n# conocidos (media y desviacion).El análisis seleccionado será bilateral, elegiendo como hipótesis\n# nula el valor de la media población y como hipotesis alternativa que esta es distinta\n# Elegimos un nivel de significación para el contraste del 0.05 y como estadístico\n# Media.muestral - Media.Poblacion/  (desviacion poblac / sqrt(tamanno de la muestra))\nmedia.muestral <- 15.95\nmedia.poblacion <- 16\ndesviacion.poblacion <- 0.12\ntamanno.muestra <- 50\n\nestadistico <-\n  (media.muestral - media.poblacion) /( (desviacion.poblacion)/sqrt(tamanno.muestra) )\n\nlambda <- qnorm(0.95,0,1)\n\nprint(lambda) #  1.644854\n\nprint(estadistico) # -2.946278 .Esta fuera. El jefe tenia razon\n\n# p-valor\nprint(pnorm(-2.946278,0,1))  # 0.00160 < 0.05 luego el jefe tenia razón...como siempre!\n\n\n\n\n\n##########################################################################\n#                 3º- EJERCICIO                                          #\n##########################################################################\n\nrm(list=ls())\n\nlibrary(MASS)\ndata(crabs)\ncangrejos<-crabs\n\n#------ analisis del lóbulo frontal\n#----------------------------------\n\n# Hacemos una primera aproximación representando el histogra...\nhist(cangrejos$FL,xlab=\"tamaño lobulo frontal\",main=\"densidad por tamaño lobulo frontal\",\n       col=\"darkgrey\",freq=F)\nmedia<- mean(cangrejos$FL)  # 15.583\ndesviacion <- sd(cangrejos$FL) # 3.495\ntamaño <- nrow(cangrejos)\n\nmuestra<-sort(rnorm(250,media,desviacion))\n\n# ...contra  una normal 'teorica' basada en los parametros de la muestra.\nlines(muestra,dnorm(muestra,media,desviacion),col=\"red\")\n\n# Realizamos un ajuste apoyados en la función fitdistr que estima los parametros de\n# la poblacion por el metodo de máxima verosimilitud con la medida del error tipico.\n ajuste.normal <- fitdistr(cangrejos$FL,\"normal\") # mean=15.5830 (0.2465)\n                                                  # sd=3.4866 (0.17433)\n ajuste.parametros <- ajuste.normal$estimate\n lines(muestra,dnorm(muestra,ajuste.parametros[1],ajuste.parametros[2]),col=\"blue\")\n\n# De manera cuantitativa vamos a realizar un contraste no parametrico para medir\n# la bondad del ajuste y permita dar una respuesta concluyente.\n# Tomamos por ejemplo el contraste de Kolmogorov-Smirnoff\n # HIPOTESIS NULA: Los datos pertenecen a la normal\n\nks.test(unique(cangrejos$FL),\"pnorm\",mean(unique(cangrejos$FL)),sd(unique(cangrejos$FL)),\n        alternative = \"two.sided\") # p-value- 0.866  0.05 osea se acepta la bondad del ajuste\n\nshapiro.test(cangrejos$FL) # p-value= 0.203\n\n\n#------ intervalor de confianza para la media y la varianza del  lóbulo frontal\n#----------------------------------\n\n#--- Asumimos que la población sigue una distribución de población normal con\n#--- parámetros desconocidos (Media y desviación). Al no conocer la desivación poblacional\n#--- se utiliza un estadistico apoya en la distribucion de t-student\n\n#--- intervalo media (nivel alpha=0.05)\n#### PDTE CONFIRMAR TAMPO N-1 o N\nalpha=0.05\ncota.inferior.medlb <- media - qt(1-alpha/2,tamaño -1)*desviacion / sqrt(tamaño - 1) #15.09439\ncota.superior.medlb <- media + qt(1-alpha/2,tamaño -1)*desviacion / sqrt(tamaño - 1) #16.07161\n\n#aproximacion por la normal\ncota.superior.medlb <- media - qnorm(alpha/2,0,1)*desviacion / sqrt(tamaño) #16.06742\ncota.inferior.medlb <- media + qnorm(alpha/2,0,1)*desviacion / sqrt(tamaño) #15.09858\n\n#--- intervalo para la varianza\nalpha=0.05\ncota.inferior.varlb <- (tamaño - 1)*var(cangrejos$FL) / qchisq(1-alpha/2,tamaño - 1) #10.13188\ncota.superior.varlb <- (tamaño - 1)*var(cangrejos$FL) / qchisq(alpha/2,tamaño - 1)  # 15.02379\n\n\n\n\n#------ Influye el sexo en el tamaño del lobulo\n# Vamos hacer un contraste de hioitesis por diferencia de medias para los dos grupos\ncangrejos.machos  <- cangrejos[cangrejos$sex ==\"M\",\"FL\"]\ncangrejos.hembras <- cangrejos[cangrejos$sex ==\"F\",\"FL\"]\n\n# hacemos el t.test\nt.test(cangrejos.machos,cangrejos.hembras,alternative=c(\"two.sided\"),conf.level=0.95)\n# p-value = 0.5426  p-valor alto las diferncias detectadas son minimas\n# t = 0.60998\n\n\n#----- Influye la especie en el tamaño del lobulo\ncangrejos.espc.o  <- cangrejos[cangrejos$sp == \"O\",\"FL\"]\ncangrejos.espc.b  <- cangrejos[cangrejos$sp == \"B\",\"FL\"]\n\nt.test(cangrejos.espc.o,cangrejos.espc.b,alternative=c(\"two.sided\"),conf.level=0.95)\n#  p-value = 8.97e-11\n# t = 6.8551\n\n#######  ANALISIS VISUAL\nattach(cangrejos)\nlibrary(lattice)\nhistogram( ~ FL | sp, data = crabs)\nhistogram( ~ FL | sex, data = crabs)\n\nbwplot( ~ FL | sex, data = crabs, layout = c(1, 2))\nbwplot( ~ FL | sp, data = crabs, layout = c(1, 2))\n\nbwplot(sex ~ FL | sp, data = crabs, layout = c(1, 2))\n\n\n\nqqnorm(crabs[, \"FL\"])\nqqline(crabs[, \"FL\"])\n\nlibrary(scatterplot3d)\nscatterplot3d(CL, CW, RW, color = ifelse(crabs$sp == \"O\", \"orange\", \"blue\"))\n\nmatriz <- data.matrix(crabs[, -c(1, 2, 3)])\nvect <- as.vector(t(matriz))\nnombres <- factor(rep(names(crabs[, -c(1, 2, 3)]), 200))\nespecie <- rep(crabs$sp, each = 5)\ncangrejos <- data.frame(caract = nombres, val = vect, esp = especie)\ncangrejos[1:10,]\nmatriz[1:2,]\nrownames(matriz) <- as.character(crabs$sp)\nbiplot(prcomp(matriz), choice = 2:3)\nhelp(crabs)\n\n\nlibrary(ggplot2)\n\n\n",
    "created" : 1477749716526.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2949846618",
    "id" : "E34ED567",
    "lastKnownWriteTime" : 1477844901,
    "path" : "C:/Users/jfuente/Desktop/Contraste de Hipotesis/Intervalos de confianza - Daniel Girela/practica contrastes.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}